#
# create a shared library
#

CFLAGS = -c -g -Wall -pthread -fPIC -I.
LDFLAGS = -shared -lpthread -pthread

OBJS = buffer.o mailbox-lf.o monitoring.o scheduler.o stream.o \
       streamset.o task.o taskqueue.o lpel_main.o worker.o \
       ctx_amd64.o
       # mailbox-lf.o 

TARGET = liblpel.so

all: $(TARGET)

$(TARGET): $(OBJS)
	gcc $(LDFLAGS) -o $@ $(OBJS)

%.o: %.c
	gcc $(CFLAGS) $<

%.o: %.S
	gcc $(CFLAGS) $<

clean:
	rm -fr $(OBJS) $(TARGET)
